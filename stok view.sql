select `tabel`.`id_barang` AS `id_barang`,
sum(`tabel`.`saldo_stok`) AS `stok` 
from (select `pos2024`.`barang_adjusment_stok`.`id_barang` AS `id_barang`,
			`pos2024`.`barang_adjusment_stok`.`id_gudang` AS `id_gudang`,
			`pos2024`.`barang_adjusment_stok`.`adjusment_stok` AS `saldo_stok`,'adjusment' AS `jenis` from `pos2024`.`barang_adjusment_stok` union all select `pos2024`.`penjualan_detail`.`id_barang` AS `id_barang`,
			`pos2024`.`penjualan`.`id_gudang` AS `id_gudang`,cast(`pos2024`.`penjualan_detail`.`qty` as signed) * -1 AS `saldo_stok`,'penjualan' AS `jenis` from (`pos2024`.`penjualan_detail` left join `pos2024`.`penjualan` on(`pos2024`.`penjualan_detail`.`id_penjualan` = `pos2024`.`penjualan`.`id_penjualan`)) union all select `pos2024`.`penjualan_detail`.`id_barang` AS `id_barang`,`pos2024`.`penjualan`.`id_gudang` AS `id_gudang`,`pos2024`.`penjualan_retur_detail`.`qty_retur` AS `saldo_stok`,'penjualan_retur' AS `jenis` from ((`pos2024`.`penjualan_retur_detail` left join `pos2024`.`penjualan_detail` on(`pos2024`.`penjualan_retur_detail`.`id_penjualan_detail` = `pos2024`.`penjualan_detail`.`id_penjualan_detail`)) left join `pos2024`.`penjualan` on(`pos2024`.`penjualan_detail`.`id_penjualan` = `pos2024`.`penjualan`.`id_penjualan`)) union all select `pos2024`.`pembelian_detail`.`id_barang` AS `id_barang`,`pos2024`.`pembelian`.`id_gudang` AS `id_gudang`,`pos2024`.`pembelian_detail`.`qty` AS `saldo_stok`,'pembelian' AS `jenis` from (`pos2024`.`pembelian_detail` left join `pos2024`.`pembelian` on(`pos2024`.`pembelian_detail`.`id_pembelian` = `pos2024`.`pembelian`.`id_pembelian`)) union all select `pos2024`.`pembelian_detail`.`id_barang` AS `id_barang`,`pos2024`.`pembelian`.`id_gudang` AS `id_gudang`,cast(`pos2024`.`pembelian_retur_detail`.`qty_retur` as signed) * -1 AS `saldo_stok`,'pembelian_retur' AS `jenis` from ((`pos2024`.`pembelian_retur_detail` left join `pos2024`.`pembelian_detail` on(`pos2024`.`pembelian_retur_detail`.`id_pembelian_detail` = `pos2024`.`pembelian_detail`.`id_pembelian_detail`)) left join `pos2024`.`pembelian` on(`pos2024`.`pembelian_detail`.`id_pembelian` = `pos2024`.`pembelian`.`id_pembelian`)) union all select `pos2024`.`transfer_barang_detail`.`id_barang` AS `id_barang`,`pos2024`.`transfer_barang`.`id_gudang_asal` AS `id_gudang_asal`,cast(`pos2024`.`transfer_barang_detail`.`qty_transfer` as signed) * -1 AS `saldo_stok`,'transfer_keluar' AS `jenis` from (`pos2024`.`transfer_barang_detail` left join `pos2024`.`transfer_barang` on(`pos2024`.`transfer_barang_detail`.`id_transfer_barang` = `pos2024`.`transfer_barang`.`id_transfer_barang`)) union all select `pos2024`.`transfer_barang_detail`.`id_barang` AS `id_barang`,`pos2024`.`transfer_barang`.`id_gudang_asal` AS `id_gudang_asal`,`pos2024`.`transfer_barang_detail`.`qty_transfer` AS `saldo_stok`,'transfer_masuk' AS `jenis` from (`pos2024`.`transfer_barang_detail` left join `pos2024`.`transfer_barang` on(`pos2024`.`transfer_barang_detail`.`id_transfer_barang` = `pos2024`.`transfer_barang`.`id_transfer_barang`))) `tabel` 
			group by `tabel`.`id_barang`